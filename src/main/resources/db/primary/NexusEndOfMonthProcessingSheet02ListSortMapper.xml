<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.nexus.NexusEndOfMonthProcessingBatch.domain.primary.mapper.NexusEndOfMonthProcessingSheet02ListSortMapper">
    <resultMap id="NexusEndOfMonthProcessingSheet02ListSortResultMap" type="com.nexus.NexusEndOfMonthProcessingBatch.domain.primary.entity.NexusEndOfMonthProcessingSheet02ListSortEntity">
        <result column="account_id" property="accountId"/>
        <result column="record_id" property="recordId"/>
        <result column="sort" property="sort"/>
        <result column="registered_user_id" property="registeredUserId"/>
        <result column="registered_date" property="registeredDate" typeHandler="com.nexus.NexusEndOfMonthProcessingBatch.domain.type_handler.LocalDateTimeTypeHandler"/>
        <result column="update_user_id" property="updateUserId"/>
        <result column="update_date" property="updateDate" typeHandler="com.nexus.NexusEndOfMonthProcessingBatch.domain.type_handler.LocalDateTimeTypeHandler"/>
    </resultMap>

    <insert id="insertList" parameterType="hashmap">
        INSERT INTO nexus_end_of_month_processing_sheet_02_list_sort (

        account_id,
        record_id,
        sort,
        registered_user_id,
        registered_date

        ) VALUES
        <foreach collection="entities" item="entity" open="(" separator=") , (" close=")">
            ${entity.accountId},
            ${entity.recordId},
            ${entity.sort},
            ${entity.registeredUserId},
            now()
        </foreach>

        ON DUPLICATE KEY UPDATE

        account_id = account_id,
        record_id = record_id,
        sort = VALUES(sort),
        update_user_id = VALUES(registered_user_id),
        update_date = VALUES(registered_date)
    </insert>

    <delete id="deleteByRecordId" parameterType="hashmap">
        DELETE FROM nexus_end_of_month_processing_sheet_02_list_sort WHERE record_id = ${recordId}
    </delete>

</mapper>